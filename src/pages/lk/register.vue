<template>
  <q-page class="main-bg ">
    <div class="container ">
      <div class="register-wrapper">
        <div class="register-left">
          <p class="register-left__title">функции нового <span class="block">b2b-портала:</span></p>
          <div class="register-left__item">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M53.3335 15.9997H47.5202C47.8135 15.173 48.0002 14.2663 48.0002 13.333C48.0002 8.90634 44.4268 5.33301 40.0002 5.33301C37.2002 5.33301 34.7735 6.77301 33.3335 8.93301L32.0002 10.7197L30.6668 8.90634C29.2268 6.77301 26.8002 5.33301 24.0002 5.33301C19.5735 5.33301 16.0002 8.90634 16.0002 13.333C16.0002 14.2663 16.1868 15.173 16.4802 15.9997H10.6668C7.70683 15.9997 5.36016 18.373 5.36016 21.333L5.3335 50.6663C5.3335 53.6263 7.70683 55.9997 10.6668 55.9997H53.3335C56.2935 55.9997 58.6668 53.6263 58.6668 50.6663V21.333C58.6668 18.373 56.2935 15.9997 53.3335 15.9997ZM40.0002 10.6663C41.4668 10.6663 42.6668 11.8663 42.6668 13.333C42.6668 14.7997 41.4668 15.9997 40.0002 15.9997C38.5335 15.9997 37.3335 14.7997 37.3335 13.333C37.3335 11.8663 38.5335 10.6663 40.0002 10.6663ZM24.0002 10.6663C25.4668 10.6663 26.6668 11.8663 26.6668 13.333C26.6668 14.7997 25.4668 15.9997 24.0002 15.9997C22.5335 15.9997 21.3335 14.7997 21.3335 13.333C21.3335 11.8663 22.5335 10.6663 24.0002 10.6663ZM53.3335 50.6663H10.6668V45.333H53.3335V50.6663ZM53.3335 37.333H10.6668V21.333H24.2135L18.6668 28.8797L22.9868 31.9997L29.3335 23.3597L32.0002 19.733L34.6668 23.3597L41.0135 31.9997L45.3335 28.8797L39.7868 21.333H53.3335V37.333Z" fill="#8F8C9E"/>
            </svg>
            <p>Доступ к оптовым ценам</p>
          </div>
          <div class="register-left__item">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M29.3332 24.0003H34.6665V16.0003H42.6665V10.667H34.6665V2.66699H29.3332V10.667H21.3332V16.0003H29.3332V24.0003ZM18.6665 48.0003C15.7332 48.0003 13.3598 50.4003 13.3598 53.3337C13.3598 56.267 15.7332 58.667 18.6665 58.667C21.5998 58.667 23.9998 56.267 23.9998 53.3337C23.9998 50.4003 21.5998 48.0003 18.6665 48.0003ZM45.3332 48.0003C42.3998 48.0003 40.0265 50.4003 40.0265 53.3337C40.0265 56.267 42.3998 58.667 45.3332 58.667C48.2665 58.667 50.6665 56.267 50.6665 53.3337C50.6665 50.4003 48.2665 48.0003 45.3332 48.0003ZM19.1198 39.3337L19.1998 39.0137L21.5998 34.667H41.4665C43.4665 34.667 45.2265 33.5737 46.1332 31.9203L56.4265 13.227L51.7865 10.667H51.7598L48.8265 16.0003L41.4665 29.3337H22.7465L22.3998 28.6137L16.4265 16.0003L13.8932 10.667L11.3865 5.33366H2.6665V10.667H7.99984L17.5998 30.907L13.9998 37.4403C13.5732 38.187 13.3332 39.067 13.3332 40.0003C13.3332 42.9337 15.7332 45.3337 18.6665 45.3337H50.6665V40.0003H19.7865C19.4398 40.0003 19.1198 39.707 19.1198 39.3337Z" fill="#8F8C9E"/>
            </svg>


            <p>Быстрый выбор популярных товаров</p>
          </div>
          <div class="register-left__item">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M37.3332 5.33301H15.9998C13.0665 5.33301 10.6932 7.73301 10.6932 10.6663L10.6665 53.333C10.6665 56.2663 13.0398 58.6663 15.9732 58.6663H47.9998C50.9332 58.6663 53.3332 56.2663 53.3332 53.333V21.333L37.3332 5.33301ZM42.6665 47.9997H21.3332V42.6663H42.6665V47.9997ZM42.6665 37.333H21.3332V31.9997H42.6665V37.333ZM34.6665 23.9997V9.33301L49.3332 23.9997H34.6665Z" fill="#8F8C9E"/>
            </svg>

            <p>Имиджевые презентации брендов</p>
          </div>

        </div>
        <div class="register-right">
          <div class="register-right__wrapper">
            <div class="register-right__form">
              <h3>регистрация
                <span>в b2b-портале
BEAUTY FORCE</span>
              </h3>
              <q-form
                @submit="onSubmit"
                class="q-gutter-md"
              >
                <p class="register-right__form-title">1/3 инн</p>
                <q-input
                  filled
                  class="rounded-borders form-control"
                  v-model="userData.inn"
                  label="Введите ИНН вашей компании*"
                  lazy-rules
                  :rules="[ val => val && val.length > 0 || 'Введите ИНН']"
                />
                <p class="register-right__form-title">2/3 контакты</p>
                <q-input
                  filled
                  v-model="userData.fio"
                  label="Введите ваше имя*"
                  lazy-rules
                  :rules="[
                  val => val !== null && val !== '' || 'Ведите ваше имя']"
                />
                <q-input
                  filled

                  v-model="userData.email"
                  label="Введите вашу почту *"
                  lazy-rules
                  :rules="[ val => val && val.length > 0 || 'Введите вашу почту',
                  val => email_re.test(String(val)) || 'Введите корректную почту'
                  ]"
                />
                <q-input
                  filled

                  v-model="userData.phone"
                  label="Введите номер телефона *"
                  lazy-rules
                  :rules="[
                  val => val !== null && val !== '' || 'Введите номер телефона']"
                />
                <p class="register-right__form-title">3/3 пароль</p>

                <q-input
      filled

      v-model="userData.password1"
      label="Придумайте пароль*"
      :type="isPwd ? 'password' : 'text'"
      lazy-rules
      :rules="[ val => val && val.length >= 8|| 'Пароль должен быть не менее 8 символов']">
        <template v-slot:append>
          <q-icon
            :name="isPwd ? 'visibility_off' : 'visibility'"
            class="cursor-pointer"
            @click="isPwd = !isPwd"
          />
        </template>
      </q-input>
                <q-input
      filled

      v-model="userData.password2"
      :type="isPwd ? 'password' : 'text'"
      label="Повторите придуманный пароль *"
      lazy-rules
      :rules="[ val => val && val===this.userData.password1 || 'Пароли не совпадают']">
        <template v-slot:append>
          <q-icon
            :name="isPwd ? 'visibility_off' : 'visibility'"
            class="cursor-pointer"
            @click="isPwd = !isPwd"
          />
        </template>
      </q-input>

                <div class="flex items-center" >
                    <q-checkbox v-model="accept" color="grey" />


                <p class="text-purple no-margin">Я согласен с политикой конфиденциальности</p>
                </div>


                <div>
                  <q-btn :disable="!accept" :loading="loading" label="зарегистрироваться" size="lg" class="form-button full-width" type="submit" />

                </div>
              </q-form>
            </div>
            <div class="register-right__info text-right">
              <router-link class="text-purple text-underline text-uppercase inline-block q-mb-sm"  to="/lk/login">войти в аккаунт</router-link>
              <router-link class="text-purple text-underline text-uppercase inline-block"  to="/">помощь при регистрации</router-link>
            </div>
          </div>
        </div>
      </div>
    </div>
  </q-page>
</template>

<script>
import { mapActions, mapGetters} from 'vuex'
export default {
  data () {
    return {
      accept: false,
      loading: false,

      isPwd: true,
      lang: this.$i18n.locale,
      email_re:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,


      userData:{
       password1:null,
       password2:null,
        email:null,
        inn:null,
        phone:null,
        fio:null,
      }

    }
  },
  methods: {
    ... mapActions('auth',['loginUser','logoutUser']),

    onSubmit () {
      console.log('submit')
        this.completeRegistration()
    },
    async completeRegistration() {
      this.loading = true
      try {
        let response = await this.$api.post('/auth/users/', {
          fio: this.userData.fio,
          email: this.userData.email,
          phone: this.userData.phone,
          inn: this.userData.inn,
          password: this.userData.password2,
        })
        this.$q.notify({
          message: 'Аккаунт создан',
          position: this.$q.screen.lt.sm ? 'bottom' : 'bottom-right',
          color: 'positive',
          icon: 'announcement'
        })
        this.loading = false
        this.$router.push('/lk/login')

      } catch (e) {
        this.$q.notify({
          message: 'Проверьте введеные данные',
          position: this.$q.screen.lt.sm ? 'bottom' : 'bottom-right',
          color: 'red',
          icon: 'announcement'
        })
      }
    }
  }
}
</script>
<style lang="sass">
.form-control
  font-weight: 200
.form-button
  background: #1F1A3D
  border-radius: 10px
.register
  &-wrapper
    display: grid
    grid-template-columns: 30% 70%
    grid-gap: 25px
    padding-bottom: 175px
  &-left
    background: linear-gradient(0deg, rgba(80, 76, 103, 0.2), rgba(80, 76, 103, 0.2)), #1F1A3D
    border-radius: 20px
    padding: 35px 45px
    height: fit-content
    &__title
      font-size: 40px
      font-weight: 400
      text-transform: uppercase
      line-height: 100%
      margin-bottom: 40px

    &__item
      display: grid
      grid-template-columns: 1fr 5fr
      grid-gap: 10px
      align-items: center
      margin-bottom: 35px
      &:last-child
        margin-bottom: 0
      p
        font-size: 20px
        font-weight: 200
        text-transform: uppercase
        line-height: 100%
        margin-bottom: 0
      svg
        margin-right: 10px

  &-right
    background: #FFFFFF
    border-radius: 20px
    padding: 35px 45px
    &__wrapper
      display: grid
      grid-template-columns: 2fr 1fr
      grid-gap: 150px
    &__form
      h3
        font-size: 50px
        line-height: 100%
        font-weight: 400
        color: #1F1A3D
        text-transform: uppercase
        margin-top: 0
        margin-bottom: 30px
        span
          color: #8F8C9E
          display: block
      &-title
        text-transform: uppercase
        color: #1F1A3D
        font-weight: 400
        font-size: 24px

    &__info
</style>
